import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as e,e as a,o as t}from"./app-BeHkqkE2.js";const l={};function n(h,i){return t(),e("div",null,i[0]||(i[0]=[a(`<h1 id="mysql-bin目录下的可执行文件" tabindex="-1"><a class="header-anchor" href="#mysql-bin目录下的可执行文件"><span>MySQL bin目录下的可执行文件</span></a></h1><p>这节我们穿插讲一点轻松的内容，关于 MySQL 安装成功后，bin 目录下的一些可执行文件，它们到底是干嘛用的？</p><figure><img src="https://cdn.tobebetterjavaer.com/stutymore/bin-20240205172946.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>我本机是 macOS 环境，目前能看到的可执行文件就如上图所示，Windows 下看到的是一些带 exe 后缀的文件，但它们的功能都是一样的。</p><h2 id="mysql" tabindex="-1"><a class="header-anchor" href="#mysql"><span>mysql</span></a></h2><p>MySQL 是 CS 架构，当客户端想要连接 MySQL 服务器的时候，就需要执行 mysql 这个可执行文件，我们在 <a href="https://javabetter.cn/mysql/install.html" target="_blank" rel="noopener noreferrer">MySQL 安装</a>的时候也讲到过。</p><p>如果 MySQL 已经添加到 PATH 环境变量中的话，不管你在任何地方打开终端，只要执行 <code>mysql -uroot -p</code> 就可以连接到 MySQL 服务器，否则就要在 bin 目录下执行 <code>./mysql -uroot -p</code> 或者 <code>mysql -uroot -p</code>（macOS 环境）。</p><p>Windows 环境的话，需要在 cmd 中切换到 bin 目录下，再执行 <code>mysql -uroot -p</code>。</p><p>我们前面也讲过为什么要这样，这里就不再赘述了。</p><p>这里讲一些连接到 MySQL 服务器后的注意事项，属于比较细节的内容。</p><h3 id="命令结束符" tabindex="-1"><a class="header-anchor" href="#命令结束符"><span>命令结束符</span></a></h3><p>在敲入一条 SQL 语句后，需要加上命令结束符 <code>;</code>，否则 MySQL 服务器会认为你还没有输入完整的 SQL 语句，会一直等待你输入，直到你输入 <code>;</code>。</p><figure><img src="https://cdn.tobebetterjavaer.com/stutymore/bin-20240205174107.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>那除了 <code>;</code> 之外，你还可以使用 <code>\\g</code> 或者 <code>\\G</code> 作为命令结束符，它们的区别是：</p><ul><li><code>;</code>：表示一次性执行所有 SQL 语句；</li><li><code>\\g</code>：同上；</li><li><code>\\G</code>：表示一次性执行所有 SQL 语句，并且以纵向显示结果，如果查询结果的列数比较多的话，该结尾符会让结果更加清晰。</li></ul><figure><img src="https://cdn.tobebetterjavaer.com/stutymore/bin-20240205174327.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="命令可以随意换行" tabindex="-1"><a class="header-anchor" href="#命令可以随意换行"><span>命令可以随意换行</span></a></h3><p>在输入 SQL 语句的时候，可以随意换行，不需要在意换行的位置，只要 SQL 语句的逻辑是正确的，MySQL 服务器就会认为你输入的是一条完整的 SQL 语句。</p><figure><img src="https://cdn.tobebetterjavaer.com/stutymore/bin-20240205174621.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="一次性执行多条-sql-语句" tabindex="-1"><a class="header-anchor" href="#一次性执行多条-sql-语句"><span>一次性执行多条 SQL 语句</span></a></h3><p>可以在一行 SQL 语句里执行多条 SQL 语句，只需要用 <code>;</code> 分隔开即可。这对于批量执行 SQL 语句是非常方便的。</p><p>举例来说，下面的 SQL 语句就是一次性执行了两条 SQL 语句。</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">show databases; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">use</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> mysql;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://cdn.tobebetterjavaer.com/stutymore/bin-20240205174853.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="放弃执行-sql-语句" tabindex="-1"><a class="header-anchor" href="#放弃执行-sql-语句"><span>放弃执行 SQL 语句</span></a></h3><p>如果你输入了一条 SQL 语句，但是又不想执行了，可以输入 <code>\\c</code> 来放弃执行。</p><p>当你SQL 输错了，又懒得删改，就可以使用 <code>\\c</code> 来放弃执行。</p><figure><img src="https://cdn.tobebetterjavaer.com/stutymore/bin-20240205175026.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="sql-语句大小写不敏感" tabindex="-1"><a class="header-anchor" href="#sql-语句大小写不敏感"><span>SQL 语句大小写不敏感</span></a></h3><p>MySQL 默认对命令的大小写是不敏感的，也就是说，你可以随意输入大小写，MySQL 服务器都会认为你输入的是一样的。</p><figure><img src="https://cdn.tobebetterjavaer.com/stutymore/bin-20240205175153.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>不过通常来说，SQL 语句的关键字都是大写的，而表名、字段名等都是小写的，这样可以让 SQL 语句更加清晰。</p><blockquote><p>不过，这只是一种约定，不是强制的。</p></blockquote><h3 id="字符串的引号" tabindex="-1"><a class="header-anchor" href="#字符串的引号"><span>字符串的引号</span></a></h3><p>在 SQL 语句中，可以使用单引号或者双引号表示字符串字面量。</p><figure><img src="https://cdn.tobebetterjavaer.com/stutymore/bin-20240205175523.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>建议使用单引号，因为 MySQL 在开启 <code>ANSI_QUOTES</code> 模式的情况下，双引号会有其他特殊的含义。</p><figure><img src="https://cdn.tobebetterjavaer.com/stutymore/bin-20240205175915.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>查询 MySQL 是不是开启了 <code>ANSI_QUOTES</code> 模式，可以使用 <code>show variables like &#39;sql_mode&#39;;</code> 来查询。</p><figure><img src="https://cdn.tobebetterjavaer.com/stutymore/bin-20240205180347.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>可以看到默认是没有开启的。</p><p>我们可以使用单引号和双引号来定义字符串，使用反引号 \` 来定义标识符，比如表名、字段名等。</p><figure><img src="https://cdn.tobebetterjavaer.com/stutymore/bin-20240205180656.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>我们给 sql_mode 添加 <code>ANSI_QUOTES</code> 模式：</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">set</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> sql_mode</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION,ANSI_QUOTES&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://cdn.tobebetterjavaer.com/stutymore/bin-20240205181238.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>再执行下面的 SQL 语句：</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> \`title\`</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;short_title&quot;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> FROM</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> \`article\`</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>会发现，双引号也被认为是标识符了，和反引号 \` 的效果是一样的。</p><figure><img src="https://cdn.tobebetterjavaer.com/stutymore/bin-20240205181258.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="退出-mysql-连接" tabindex="-1"><a class="header-anchor" href="#退出-mysql-连接"><span>退出 MySQL 连接</span></a></h3><p>在 MySQL 连接状态下，可以使用 <code>exit</code>、<code>quit</code>、<code>\\q</code>、<code>Ctrl + D</code> 来退出连接。</p><figure><img src="https://cdn.tobebetterjavaer.com/stutymore/bin-20240205181608.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>看，我们在添加 sql_mode 的时候，是针对当前连接 session 的，所以当我们退出连接后，再重新连接，就会发现 sql_mode 又变成了默认的。</p><h2 id="mysqldump" tabindex="-1"><a class="header-anchor" href="#mysqldump"><span>mysqldump</span></a></h2><p>mysqldump 是一个非常实用的 MySQL 数据库备份工具，用于创建一个或多个 MySQL 数据库级别的 SQL 转储文件，包括数据库的表结构和数据。对数据备份、迁移或恢复非常重要。</p><p>备份整个数据库的语法如下：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysqldump</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -u</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [username] -p[password] [database_name] &gt; [filename].sql</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><code>-u</code>：指定用户名；</li><li><code>-p</code>：指定密码；如果没有输入密码，系统会在执行命令后提示输入密码；</li><li><code>database_name</code>：指定要备份的数据库；</li><li><code>filename</code>：指定备份文件的名称。</li></ul><p>比如说，我要备份<a href="%5Bhttps://%5D(https://javabetter.cn/zhishixingqiu/paicoding.html)">技术派实战项目</a>的整个数据库，可以使用下面的命令：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysqldump</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -uroot</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pai_coding</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">pai_coding.sql</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>执行完再打个压缩包：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">gzip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pai_coding.sql</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://cdn.tobebetterjavaer.com/stutymore/bin-20240205183507.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>也可以备份指定的表，比如说，我要备份 article 表：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysqldump</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -uroot</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pai_coding</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> article</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">article.sql</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>在数据库名后面加上表名就好了。</p><p>也可以备份多个数据库，比如说，我要备份 pai_coding 和 test 两个数据库：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysqldump</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -uroot</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --databases</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pai_coding</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">pai_coding_test.sql</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>使用 <code>--databases</code> 参数，后面跟上要备份的数据库名，中间用空格隔开。</p><p>要备份所有数据库的话，可以使用 <code>--all-databases</code> 参数。</p><p>在生产环境中，为了防止数据丢失，我们可以编写脚本并使用 <a href="https://help.aliyun.com/document_detail/133509.html" target="_blank" rel="noopener noreferrer">cron 表达式</a>在后台自动执行这些备份操作。</p><p>我们来写一个简单的备份脚本：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># 设置 MySQL 用户名、密码、数据库名和备份目录</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">MYSQL_USER</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;your_username&quot;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">MYSQL_PASSWORD</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;your_password&quot;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">DATABASE_NAME</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;your_database_name&quot;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">BACKUP_DIR</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;/path/to/your/backup/directory&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># 生成备份文件名，包含日期</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">DATE</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">date</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> +%Y%m%d_%H%M%S</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">BACKUP_FILE</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$BACKUP_DIR</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$DATABASE_NAME_$DATE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.sql&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># 使用 mysqldump 创建数据库备份</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysqldump</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -u</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $MYSQL_USER</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$MYSQL_PASSWORD</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $DATABASE_NAME</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$BACKUP_FILE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># 检查备份操作是否成功</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$?</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -eq</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ]; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">  echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;数据库备份成功: </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$BACKUP_FILE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">else</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">  echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;备份出错了！&quot;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">fi</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>将上面的脚本保存为 <code>backup.sh</code>，然后添加执行权限：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> +x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> backup.sh</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>然后执行脚本：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">./backup.sh</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://cdn.tobebetterjavaer.com/stutymore/bin-20240205185257.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>OK，打开 crontab：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">crontab</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -e</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>添加一行：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 3</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> *</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> *</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> *</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /path/to/your/backup.sh</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>这样就可以在每天凌晨三点执行备份操作了。我就不再演示了。</p><p>当数据库较大时，mysqldump 可能会消耗较长的时间和系统资源，所以尽量在数据库不繁忙的时候执行备份操作，比如说凌晨两三点。</p><p>对于非常大的数据库，可以使用 <code>--single-transaction</code> 参数来执行备份，这样可以避免锁表，但是要求数据库引擎是 <a href="https://javabetter.cn/mysql/InnoDB.html" target="_blank" rel="noopener noreferrer">InnoDB</a>。</p><h2 id="mysqladmin" tabindex="-1"><a class="header-anchor" href="#mysqladmin"><span>mysqladmin</span></a></h2><p>mysql 后面加上 admin 就表明这是一个 MySQL 的管理工具，它可以用来执行一些管理操作，比如说创建数据库、删除数据库、查看 MySQL 服务器的状态等。</p><p>比如说，我要查看 MySQL 服务器的状态：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysqladmin</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -uroot</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> status</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://cdn.tobebetterjavaer.com/stutymore/bin-20240205190217.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>比如说，重新加载授权表、刷新日志文件等：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysqladmin</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -uroot</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> flush-privileges</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysqladmin</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -uroot</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reload</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysqladmin</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -uroot</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> flush-logs</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>flush-privileges 和 reload 是一样的效果。</li><li>flush-logs 是刷新日志文件。</li></ul><p>比如说，我要创建一个数据库：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysqladmin</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -uroot</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> create</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>比如说，我要删除一个数据库：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysqladmin</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -uroot</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> drop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>在自动化脚本中，会经常使用 mysqladmin 来执行一些管理操作。</p><h2 id="mysqlcheck" tabindex="-1"><a class="header-anchor" href="#mysqlcheck"><span>mysqlcheck</span></a></h2><p>mysqlcheck 是 MySQL 提供的一个命令行工具，用于检查、修复、分析和优化数据库表，对数据库的维护和性能优化非常有用。</p><p>比如说，我要检查数据库的所有表：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysqlcheck</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -uroot</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --check</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> your_database_name</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://cdn.tobebetterjavaer.com/stutymore/bin-20240205191424.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="mysqlimport" tabindex="-1"><a class="header-anchor" href="#mysqlimport"><span>mysqlimport</span></a></h2><p>mysqlimport 用于从文本文件中导入数据到数据库表中，非常适合用于批量导入数据。比如说，我有一个 CSV 文件，我要导入到数据库表中：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysqlimport</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -uroot</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --fields-terminated-by=,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --fields-enclosed-by=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;&quot;&#39;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --lines-terminated-by=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;\\n&#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> your_database_name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> your_table_name.csv</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><code>--fields-terminated-by</code>：指定字段之间的分隔符；</li><li><code>--fields-enclosed-by</code>：指定字段的包围符；</li><li><code>--lines-terminated-by</code>：指定行的结束符。</li><li><code>your_table_name.csv</code>：指定要导入的文件。</li><li><code>your_database_name</code>：指定要导入的数据库。</li></ul><p>好，我们来创建一个 CSV 文件：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;1, &#39;Java&#39;, &#39;Java is the best language&#39;, &#39;2022-02-05 19:30:00&#39;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">article.csv</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;2, &#39;Python&#39;, &#39;Python is the best language&#39;, &#39;2022-02-05 19:30:00&#39;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt;&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">article.csv</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;3, &#39;Go&#39;, &#39;Go is the best language&#39;, &#39;2022-02-05 19:30:00&#39;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt;&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">article.csv</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>接着创建一张表：</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">CREATE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> TABLE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> \`</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">article</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">\` (</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  \`id\`</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">11</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">NOT NULL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> AUTO_INCREMENT,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  \`title\`</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> varchar</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">255</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">NOT NULL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  \`content\`</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> text</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> NOT NULL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  \`create_time\`</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> datetime</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> NOT NULL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  PRIMARY KEY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">\`id\`</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) ENGINE</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">InnoDB </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">DEFAULT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> CHARSET</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">utf8mb4;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后导入：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysqlimport</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -uroot</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --fields-terminated-by=,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --fields-enclosed-by=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;&quot;&#39;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --lines-terminated-by=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;\\n&#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pai_coding</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> article.csv</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>哦，出现了 <code>--secure-file-priv</code> 错误：</p><figure><img src="https://cdn.tobebetterjavaer.com/stutymore/bin-20240205194729.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>我们可以先查看一下 <code>--secure-file-priv</code> 参数的值：</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">show variables </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">like</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;secure_file_priv&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://cdn.tobebetterjavaer.com/stutymore/bin-20240205195109.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>为 null，表明 MySQL 并没有限制导入文件的目录。我们只需要加入 <code>--local</code> 参数即可：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysqlimport</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -uroot</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --fields-terminated-by=,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --fields-enclosed-by=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;&quot;&#39;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --lines-terminated-by=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;\\n&#39;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --local</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pai_coding</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> article.csv</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://cdn.tobebetterjavaer.com/stutymore/bin-20240205195624.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>OK，导入成功。</p><figure><img src="https://cdn.tobebetterjavaer.com/stutymore/bin-20240205195636.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="mysqlshow" tabindex="-1"><a class="header-anchor" href="#mysqlshow"><span>mysqlshow</span></a></h2><p>mysqlshow 用于显示 MySQL 数据库服务器中的数据库、表、列等信息。</p><p>比如说，我要查看数据库中的所有表：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysqlshow</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -uroot</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> your_database_name</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://cdn.tobebetterjavaer.com/stutymore/bin-20240205200127.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>比如说，我要查看表中的所有列：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysqlshow</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -uroot</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> your_database_name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> your_table_name</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://cdn.tobebetterjavaer.com/stutymore/bin-20240205200227.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>比如说，我要查看表的索引信息：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysqlshow</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -uroot</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --keys</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> your_database_name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> your_table_name</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://cdn.tobebetterjavaer.com/stutymore/bin-20240205200416.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>在部署新应用或进行数据库迁移时，可以使用 mysqlshow 快速确认目标数据库是否已经存在。</p><h2 id="mysqlbinlog" tabindex="-1"><a class="header-anchor" href="#mysqlbinlog"><span>mysqlbinlog</span></a></h2><p>mysqlbinlog 用于查看 MySQL 二进制日志文件的内容，可以用于恢复数据、查看数据变更等。二进制日志是 MySQL 服务器的一个重要特性，记录了数据库更改的所有“事件”，如表的创建、数据的插入、更新和删除操作。</p><p>如果发生数据丢失或损坏，就可以使用 mysqlbinlog 来查看和恢复自上次备份以来执行的更改。</p><p>比如说，我要查看二进制日志文件的内容：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysqlbinlog</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -uroot</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /path/to/your/binlog.000001</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>前提条件是你已经开启了二进制日志。</p><p>假设你想要查看并恢复从昨天晚上 10 点到今天早上 2 点之间发生的所有数据库更改，你可以使用 mysqlbinlog 的 <code>--start-datetime</code> 和 <code>--stop-datetime</code> 选项来过滤这个时间范围内的事件：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysqlbinlog</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --start-datetime=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;YYYY-MM-DD 22:00:00&quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">            --stop-datetime=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;YYYY-MM-DD 02:00:00&quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            /path/to/binlog-file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/path/to/output.sql</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这部分我们在讲 <a href="https://javabetter.cn/mysql/binlog.html" target="_blank" rel="noopener noreferrer">binlog</a> 的时候会详细讲。</p><h2 id="其他" tabindex="-1"><a class="header-anchor" href="#其他"><span>其他</span></a></h2><p>bin 目录下还有一些其他的可执行文件，比如说 mysqlslap、mysql_upgrade、mysqld_safe、mysql_secure_installation、mysqlpump、mysql_config、mysql_tzinfo_to_sql 等等，我们就不一次性全讲了，后面遇到我觉得值得给大家细讲的，我们再回来来补充。</p><p>这里就简单做一个表格吧：</p><table><thead><tr><th>可执行文件</th><th>作用</th></tr></thead><tbody><tr><td>mysqlslap</td><td>用于模拟多个客户端并发访问 MySQL 服务器，用于测试 MySQL 服务器的性能。</td></tr><tr><td>mysql_upgrade</td><td>用于升级 MySQL 数据库。</td></tr><tr><td>mysqld_safe</td><td>用于启动 MySQL 服务器的守护进程。</td></tr><tr><td>mysql_secure_installation</td><td>用于执行一系列安全相关的操作来提高 MySQL 安装的安全性。它包括设置 root 密码、删除匿名用户、禁用远程 root 登录等步骤。</td></tr><tr><td>mysqlpump</td><td>一个类似于 mysqldump 的 MySQL 备份工具，但它支持并行备份操作，可以更快地备份大型数据库。</td></tr><tr><td>mysql_config</td><td>用于获取编译和链接客户端应用所需的 MySQL 选项的脚本。</td></tr><tr><td>mysql_tzinfo_to_sql</td><td>用于加载时区信息到 MySQL 服务器。</td></tr></tbody></table><h2 id="小结" tabindex="-1"><a class="header-anchor" href="#小结"><span>小结</span></a></h2><p>bin 目录下的可执行文件合起来为 MySQL 的安装、运行、管理和维护提供了全面的支持。</p><hr><p>GitHub 上标星 10000+ 的开源知识库《<a href="https://github.com/itwanger/toBeBetterJavaer" target="_blank" rel="noopener noreferrer">二哥的 Java 进阶之路</a>》第一版 PDF 终于来了！包括Java基础语法、数组&amp;字符串、OOP、集合框架、Java IO、异常处理、Java 新特性、网络编程、NIO、并发编程、JVM等等，共计 32 万余字，500+张手绘图，可以说是通俗易懂、风趣幽默……详情戳：<a href="https://javabetter.cn/overview/" target="_blank" rel="noopener noreferrer">太赞了，GitHub 上标星 10000+ 的 Java 教程</a></p><p>微信搜 <strong>沉默王二</strong> 或扫描下方二维码关注二哥的原创公众号沉默王二，回复 <strong>222</strong> 即可免费领取。</p><figure><img src="https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/gongzhonghao.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,155)]))}const p=s(l,[["render",n],["__file","bin.html.vue"]]),k=JSON.parse('{"path":"/mysql/bin.html","title":"MySQL bin目录下的可执行文件都是用来干嘛的？","lang":"zh-CN","frontmatter":{"title":"MySQL bin目录下的可执行文件都是用来干嘛的？","shortTitle":"bin目录下的可执行文件","description":"MySQL bin目录下的可执行文件 这节我们穿插讲一点轻松的内容，关于 MySQL 安装成功后，bin 目录下的一些可执行文件，它们到底是干嘛用的？ 我本机是 macOS 环境，目前能看到的可执行文件就如上图所示，Windows 下看到的是一些带 exe 后缀的文件，但它们的功能都是一样的。 mysql MySQL 是 CS 架构，当客户端想要连接 ...","head":[["meta",{"property":"og:url","content":"https://javabetter.cn/toBeBetterJavaer/mysql/bin.html"}],["meta",{"property":"og:site_name","content":"二哥的Java进阶之路"}],["meta",{"property":"og:title","content":"MySQL bin目录下的可执行文件都是用来干嘛的？"}],["meta",{"property":"og:description","content":"MySQL bin目录下的可执行文件 这节我们穿插讲一点轻松的内容，关于 MySQL 安装成功后，bin 目录下的一些可执行文件，它们到底是干嘛用的？ 我本机是 macOS 环境，目前能看到的可执行文件就如上图所示，Windows 下看到的是一些带 exe 后缀的文件，但它们的功能都是一样的。 mysql MySQL 是 CS 架构，当客户端想要连接 ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://cdn.tobebetterjavaer.com/stutymore/bin-20240205172946.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-09-13T06:18:01.000Z"}],["meta",{"property":"article:author","content":"沉默王二"}],["meta",{"property":"article:modified_time","content":"2024-09-13T06:18:01.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"MySQL bin目录下的可执行文件都是用来干嘛的？\\",\\"image\\":[\\"https://cdn.tobebetterjavaer.com/stutymore/bin-20240205172946.png\\",\\"https://cdn.tobebetterjavaer.com/stutymore/bin-20240205174107.png\\",\\"https://cdn.tobebetterjavaer.com/stutymore/bin-20240205174327.png\\",\\"https://cdn.tobebetterjavaer.com/stutymore/bin-20240205174621.png\\",\\"https://cdn.tobebetterjavaer.com/stutymore/bin-20240205174853.png\\",\\"https://cdn.tobebetterjavaer.com/stutymore/bin-20240205175026.png\\",\\"https://cdn.tobebetterjavaer.com/stutymore/bin-20240205175153.png\\",\\"https://cdn.tobebetterjavaer.com/stutymore/bin-20240205175523.png\\",\\"https://cdn.tobebetterjavaer.com/stutymore/bin-20240205175915.png\\",\\"https://cdn.tobebetterjavaer.com/stutymore/bin-20240205180347.png\\",\\"https://cdn.tobebetterjavaer.com/stutymore/bin-20240205180656.png\\",\\"https://cdn.tobebetterjavaer.com/stutymore/bin-20240205181238.png\\",\\"https://cdn.tobebetterjavaer.com/stutymore/bin-20240205181258.png\\",\\"https://cdn.tobebetterjavaer.com/stutymore/bin-20240205181608.png\\",\\"https://cdn.tobebetterjavaer.com/stutymore/bin-20240205183507.png\\",\\"https://cdn.tobebetterjavaer.com/stutymore/bin-20240205185257.png\\",\\"https://cdn.tobebetterjavaer.com/stutymore/bin-20240205190217.png\\",\\"https://cdn.tobebetterjavaer.com/stutymore/bin-20240205191424.png\\",\\"https://cdn.tobebetterjavaer.com/stutymore/bin-20240205194729.png\\",\\"https://cdn.tobebetterjavaer.com/stutymore/bin-20240205195109.png\\",\\"https://cdn.tobebetterjavaer.com/stutymore/bin-20240205195624.png\\",\\"https://cdn.tobebetterjavaer.com/stutymore/bin-20240205195636.png\\",\\"https://cdn.tobebetterjavaer.com/stutymore/bin-20240205200127.png\\",\\"https://cdn.tobebetterjavaer.com/stutymore/bin-20240205200227.png\\",\\"https://cdn.tobebetterjavaer.com/stutymore/bin-20240205200416.png\\",\\"https://cdn.tobebetterjavaer.com/tobebetterjavaer/images/gongzhonghao.png\\"],\\"dateModified\\":\\"2024-09-13T06:18:01.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"沉默王二\\",\\"url\\":\\"/about-the-author/\\"}]}"]]},"headers":[{"level":2,"title":"mysql","slug":"mysql","link":"#mysql","children":[{"level":3,"title":"命令结束符","slug":"命令结束符","link":"#命令结束符","children":[]},{"level":3,"title":"命令可以随意换行","slug":"命令可以随意换行","link":"#命令可以随意换行","children":[]},{"level":3,"title":"一次性执行多条 SQL 语句","slug":"一次性执行多条-sql-语句","link":"#一次性执行多条-sql-语句","children":[]},{"level":3,"title":"放弃执行 SQL 语句","slug":"放弃执行-sql-语句","link":"#放弃执行-sql-语句","children":[]},{"level":3,"title":"SQL 语句大小写不敏感","slug":"sql-语句大小写不敏感","link":"#sql-语句大小写不敏感","children":[]},{"level":3,"title":"字符串的引号","slug":"字符串的引号","link":"#字符串的引号","children":[]},{"level":3,"title":"退出 MySQL 连接","slug":"退出-mysql-连接","link":"#退出-mysql-连接","children":[]}]},{"level":2,"title":"mysqldump","slug":"mysqldump","link":"#mysqldump","children":[]},{"level":2,"title":"mysqladmin","slug":"mysqladmin","link":"#mysqladmin","children":[]},{"level":2,"title":"mysqlcheck","slug":"mysqlcheck","link":"#mysqlcheck","children":[]},{"level":2,"title":"mysqlimport","slug":"mysqlimport","link":"#mysqlimport","children":[]},{"level":2,"title":"mysqlshow","slug":"mysqlshow","link":"#mysqlshow","children":[]},{"level":2,"title":"mysqlbinlog","slug":"mysqlbinlog","link":"#mysqlbinlog","children":[]},{"level":2,"title":"其他","slug":"其他","link":"#其他","children":[]},{"level":2,"title":"小结","slug":"小结","link":"#小结","children":[]}],"git":{"createdTime":1707304003000,"updatedTime":1726208281000,"contributors":[{"name":"root","email":"root@instance-tw.asia-east1-b.c.valid-arc-377619.internal","commits":1}]},"readingTime":{"minutes":10.42,"words":3125},"filePathRelative":"mysql/bin.md","localizedDate":"2024年2月7日","excerpt":"\\n<p>这节我们穿插讲一点轻松的内容，关于 MySQL 安装成功后，bin 目录下的一些可执行文件，它们到底是干嘛用的？</p>\\n<figure><img src=\\"https://cdn.tobebetterjavaer.com/stutymore/bin-20240205172946.png\\" alt=\\"\\" tabindex=\\"0\\" loading=\\"lazy\\"><figcaption></figcaption></figure>\\n<p>我本机是 macOS 环境，目前能看到的可执行文件就如上图所示，Windows 下看到的是一些带 exe 后缀的文件，但它们的功能都是一样的。</p>\\n<h2>mysql</h2>","autoDesc":true}');export{p as comp,k as data};
